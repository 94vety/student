{"ast":null,"code":"import { makeAutoObservable } from \"mobx\";\nimport { message } from \"antd\";\nimport { booksSearch, booksKind, booksKindSearch, login, register } from \"../services/index.js\";\n\nclass Mobx {\n  constructor() {\n    this.bookName = \"\";\n    this.booksPageNum = 2;\n    this.booksPageCount = 0;\n    this.booksData = [];\n    this.booksKindData = [];\n\n    this.login = async data => {\n      const event = await login(data);\n      const {\n        data: {\n          code,\n          token,\n          message: reMessage\n        }\n      } = event;\n\n      if (!code) {\n        console.log(token);\n        localStorage.setItem(\"token\", JSON.stringify(token));\n        message.success(\"登录成功\");\n        return true;\n      } else {\n        message.error(reMessage);\n        return false;\n      }\n    };\n\n    this.register = async data => {\n      const event = await register(data);\n      const {\n        data: {\n          code,\n          token,\n          message: reMessage\n        }\n      } = event;\n\n      if (!code) {\n        console.log(token);\n        localStorage.setItem(\"token\", JSON.stringify(token));\n        message.success(\"注册成功自动登录\");\n        return true;\n      } else {\n        message.error(reMessage);\n        return false;\n      }\n    };\n\n    this.booksSearch = async data => {\n      const event = await booksSearch(data);\n      const {\n        data: {\n          books,\n          num_pages\n        }\n      } = event;\n      this.booksData = books;\n      this.booksPageNum = 2;\n      this.booksPageCount = num_pages + 1;\n      this.bookName = data.q;\n    };\n\n    this.booksSearchAdd = async () => {\n      if (this.booksPageNum < this.booksPageCount) {\n        const event = await booksSearch({\n          q: this.bookName,\n          page: this.booksPageNum\n        });\n        const {\n          data: {\n            books\n          }\n        } = event;\n        this.booksPageNum = this.booksPageNum + 1;\n        this.booksData = [...this.booksData, ...books];\n      } else {\n        message.warning(\"无更多书籍\");\n      }\n    };\n\n    this.booksKindRequest = async () => {\n      const event = await booksKind();\n      this.booksKindData = event.data;\n    };\n\n    this.booksKindSearchRequest = async data => {\n      const event = await booksKindSearch(data);\n      console.log(event);\n    };\n\n    makeAutoObservable(this, {});\n  }\n\n}\n\nconst myStore = new Mobx();\nexport default myStore;","map":{"version":3,"sources":["/Users/wuliangrui/Desktop/库里泡/item/student/src/store/index.js"],"names":["makeAutoObservable","message","booksSearch","booksKind","booksKindSearch","login","register","Mobx","constructor","bookName","booksPageNum","booksPageCount","booksData","booksKindData","data","event","code","token","reMessage","console","log","localStorage","setItem","JSON","stringify","success","error","books","num_pages","q","booksSearchAdd","page","warning","booksKindRequest","booksKindSearchRequest","myStore"],"mappings":"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","sourcesContent":["import {\n    makeAutoObservable\n} from \"mobx\";\nimport { message } from \"antd\";\nimport {\n    booksSearch,\n    booksKind,\n    booksKindSearch,\n    login, register\n} from \"../services/index.js\";\n\nclass Mobx {\n    bookName = \"\"\n    booksPageNum = 2\n    booksPageCount = 0\n    booksData = []\n    booksKindData = []\n\n    constructor() {\n        makeAutoObservable(this, {\n\n        });\n    }\n\n    login = async(data) => {\n        const event = await login(data);\n        const {\n            data: { \n                code, token,\n                message: reMessage\n            }\n        } = event;\n\n        if (!code) {\n            console.log(token);\n            localStorage.setItem(\"token\", JSON.stringify(token));\n            message.success(\"登录成功\");\n            return true;\n        } else {\n            message.error(reMessage);\n            return false;\n        }\n    }\n\n    register = async(data) => {\n        const event = await register(data);\n        const {\n            data: { \n                code, token,\n                message: reMessage\n            }\n        } = event;\n\n        if (!code) {\n            console.log(token);\n            localStorage.setItem(\"token\", JSON.stringify(token));\n            message.success(\"注册成功自动登录\");\n            return true;\n        } else {\n            message.error(reMessage);\n            return false;\n        }\n    }\n\n    booksSearch = async(data) => {\n        const event = await booksSearch(data);\n        const {\n            data: {\n                books, num_pages\n            }\n        } = event;\n\n        this.booksData = books;\n        this.booksPageNum = 2;\n        this.booksPageCount = num_pages + 1;\n        this.bookName = data.q;\n    }\n\n    booksSearchAdd = async() => {\n        if (this.booksPageNum < this.booksPageCount) {\n            const event = await booksSearch({\n                q: this.bookName,\n                page: this.booksPageNum\n            });\n\n            const {\n                data: {\n                    books\n                }\n            } = event;\n\n            this.booksPageNum = this.booksPageNum + 1;\n            this.booksData = [...this.booksData, ...books];\n        } else {\n            message.warning(\"无更多书籍\");\n        }\n    }\n\n    booksKindRequest = async() => {\n        const event = await booksKind()\n\n        this.booksKindData = event.data;\n    }\n\n    booksKindSearchRequest = async(data) => {\n        const event = await booksKindSearch(data);\n        console.log(event);\n    }\n}\n\nconst myStore = new Mobx();\nexport default myStore;\n\n"]},"metadata":{},"sourceType":"module"}